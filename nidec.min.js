class Service {
  base_url = `http://172.30.1.9:8200/`;
  service;
  constructor(service) {
    this.service = service;
  }

  async get(url) {
    const response = await fetch(this.base_url + this.service + url);
    const data = await response.json();
    if (data) {
      return data;
    } else {
      return null;
    }
  }

  async getQuery(url, raw) {
    const response = await fetch(
      this.base_url +
        this.service +
        url +
        `?query_raw=${raw}`
    );
    const data_response = await response.json();
    if (data_response) {
      return data_response;
    } else {
      return null;
    }
  }

  async postQuery(url, headers, body) {
    const response = await fetch(this.base_url + this.service + url, {
      method: "POST",
      headers: headers,
      body: JSON.stringify(body),
    });
    const data = await response.json();
    if (data) {
      return data;
    } else {
      return null;
    }
  }

  handleError(error) {
    console.error(err);
  }
}

class Info extends Service {
  constructor() {
    super("api/");
  }

  getInfoData(number, colum = "user_index") {
    const data = {};
    data[colum] = number;
    return this.postQuery(
      "info/",
      {
        "Content-Type": "application/json",
      },
      data
    );
  }

  getDepartmentData(number) {
    return this.postQuery(
      "department/",
      {
        "Content-Type": "application/json",
      },
      { department_index: number }
    );
  }
}

class UserConfig extends Service {
  constructor() {
    super("api/");
  }

  getConfig(raw) {
    return this.getQuery('user_config/',raw);
  }
}

export const $api = {
  data_info: new Info(),
  user_config: new UserConfig(),
};
